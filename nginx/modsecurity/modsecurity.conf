# Security rules for ModSecurity

# Mode 1: Off mode (for development)
SecRuleEngine Off  

# Mode 2: Detection mode (for development)
# SecRuleEngine DetectionOnly  

# Mode 3: Block mode (for production)
# SecRuleEngine On  

# After changing mode rebuild the container:
# docker compose restart nginx

SecRequestBodyAccess On
SecResponseBodyAccess Off

# Audit log
SecAuditEngine RelevantOnly
SecAuditLogParts ABIJDEFHZ
SecAuditLog /var/log/modsecurity/audit.log

# Basic hardening defaults
SecRule REQUEST_HEADERS:Content-Type "^$" \
  "id:900001,phase:1,pass,log,msg:'Missing Content-Type header'"

# Example test rule (uncomment to block a request)
# SecRule REQUEST_URI "@contains /waf-test" \
#   "id:900002,phase:1,deny,status:403,msg:'WAF test block'"

